{"ast":null,"code":"var _jsxFileName = \"E:\\\\js\\\\react\\\\music-app\\\\React-musicApp\\\\src\\\\Component\\\\Main\\\\VideoPage\\\\index.jsx\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport FullScreenIcon from '../../../Icons/FullScreenIcon';\nimport PauseIcon from '../../../Icons/PauseIcon';\nimport PlayIcon from '../../../Icons/PlayIcon';\nimport SoundIcon from '../../../Icons/SoundIcon';\nimport Progress from '../../Bottom/Progress';\nimport './index.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction VideoPage() {\n  var _props$video, _props;\n\n  const video = /*#__PURE__*/React.createRef();\n  state = {\n    curTime: 0,\n    pause: false,\n    isHandling: false\n  };\n\n  function handlePause() {\n    const {\n      pause\n    } = state;\n    if (pause) video.current.play();else video.current.pause();\n    setState(state => ({\n      pause: !state.pause\n    }), () => {\n      console.log('#', state.pause);\n    });\n  } // 监听播放器进度变化\n\n\n  function handleTimeUpdate(event) {\n    // cur 传给子组件使用\n    const cur = Math.floor(event.target.currentTime); // const { isHandling } = state;\n    // if (isHandling) return;\n\n    setState({\n      curTime: cur\n    }); // 如果正在调整播放进度，则不改变进度条的长度\n\n    const width = Math.floor(cur / event.target.duration * 350) || 0; // 修改 css 变量 感觉会影响性能\n\n    document.documentElement.style.setProperty('--video-progress-bar-width', width + 'px');\n  } // 用户改变 audio 播放进度\n\n\n  function handleProgressChange(newProgress) {\n    audio.current.currentTime = newProgress;\n  }\n\n  function calcProgress(width) {\n    const newProgress = Math.floor((width || 0) * ratio);\n    handleProgressChange(newProgress);\n  }\n\n  function handleMouseDown(event) {\n    // \n    if (state.isHandling) return; // 是否是点击事件\n\n    let isClick = true;\n    const that = this;\n    const {\n      time: totalTime\n    } = props;\n    const top = event.target.closest('.Progress-slider-top');\n    const bar = event.target.closest('.Progress-slider');\n    const barCoord = bar.getBoundingClientRect(); // 没有点 top，是点击事件\n\n    if (!top) {\n      const width = event.clientX - barCoord.left;\n      calcProgress(width);\n      return;\n    }\n\n    const topCoord = top.getBoundingClientRect();\n    setState({\n      isHandling: true\n    }); // 鼠标指针点击位置与 top 左上角的 offset\n\n    const start = {\n      x: event.clientX,\n      y: event.clientY\n    };\n    const offset = {\n      x: event.clientX - topCoord.left,\n      y: event.clientY - topCoord.top\n    };\n    document.addEventListener('mousemove', handleMouseMove);\n    document.addEventListener('mouseup', handleMouseUp);\n\n    function handleMouseMove(event) {\n      if (isClick && Math.floor(Math.abs(event.clientX - start.x) * that.ratio) != 0) isClick = false; // 拖拽时只改变 css 变量的值\n\n      let width = event.clientX - barCoord.left;\n      width = width < 350 ? width : 350;\n      width = width > 0 ? width : 0;\n      that.setState({\n        curTime: Math.floor(width * that.ratio)\n      });\n      document.documentElement.style.setProperty('--progress-bar-width', width + 'px');\n    }\n\n    function handleMouseUp(event) {\n      document.removeEventListener('mousemove', handleMouseMove);\n      document.removeEventListener('mouseup', handleMouseUp);\n      that.setState({\n        isHandling: false\n      });\n      const width = event.clientX - barCoord.left;\n      if (!isClick && !event.target.closest('.Progress-slider')) bar.classList.remove('Progress-slider-hover');\n      that.calcProgress(width);\n    }\n  }\n\n  let url = (_props$video = props.video) === null || _props$video === void 0 ? void 0 : _props$video.url;\n  let totalTime = (_props = props) === null || _props === void 0 ? void 0 : _props.duration;\n  url = url ? url : '';\n  totalTime = totalTime ? totalTime / 1000 : 0;\n  const {\n    curTime,\n    isHandling,\n    pause\n  } = state;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"VideoPage\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"video-control\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"video-block\",\n        children: /*#__PURE__*/_jsxDEV(\"video\", {\n          onTimeUpdate: handleTimeUpdate,\n          height: \"100%\",\n          ref: video,\n          src: url,\n          autoPlay: true,\n          preload: \"auto\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"video-control-bar\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"video-progress\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"video-progress-bar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"video-progress-top\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          children: [/*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"video-pause\",\n            onClick: handlePause,\n            children: [pause ? /*#__PURE__*/_jsxDEV(PlayIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 140,\n              columnNumber: 26\n            }, this) : /*#__PURE__*/_jsxDEV(PauseIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 140,\n              columnNumber: 41\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [(\"0\" + Math.floor(curTime / 60)).slice(-2), \":\", (\"0\" + curTime % 60).slice(-2), \" / \", (\"0\" + Math.floor(totalTime / 60)).slice(-2), \":\", (\"0\" + totalTime % 60).slice(-2)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 141,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"video-func\",\n            children: [/*#__PURE__*/_jsxDEV(SoundIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 145,\n              columnNumber: 42\n            }, this), /*#__PURE__*/_jsxDEV(FullScreenIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 145,\n              columnNumber: 55\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 122,\n    columnNumber: 7\n  }, this);\n}\n\n_c = VideoPage;\nexport default connect(state => ({\n  video: state.video,\n  duration: state.duration\n}), {})(VideoPage);\n\nvar _c;\n\n$RefreshReg$(_c, \"VideoPage\");","map":{"version":3,"sources":["E:/js/react/music-app/React-musicApp/src/Component/Main/VideoPage/index.jsx"],"names":["React","Component","connect","FullScreenIcon","PauseIcon","PlayIcon","SoundIcon","Progress","VideoPage","video","createRef","state","curTime","pause","isHandling","handlePause","current","play","setState","console","log","handleTimeUpdate","event","cur","Math","floor","target","currentTime","width","duration","document","documentElement","style","setProperty","handleProgressChange","newProgress","audio","calcProgress","ratio","handleMouseDown","isClick","that","time","totalTime","props","top","closest","bar","barCoord","getBoundingClientRect","clientX","left","topCoord","start","x","y","clientY","offset","addEventListener","handleMouseMove","handleMouseUp","abs","removeEventListener","classList","remove","url","slice"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport FullScreenIcon from '../../../Icons/FullScreenIcon';\r\nimport PauseIcon from '../../../Icons/PauseIcon';\r\nimport PlayIcon from '../../../Icons/PlayIcon';\r\nimport SoundIcon from '../../../Icons/SoundIcon';\r\nimport Progress from '../../Bottom/Progress';\r\nimport './index.css';\r\n\r\nfunction VideoPage(){\r\n  const video = React.createRef();\r\n  \r\n  state = {\r\n    curTime: 0,\r\n    pause: false,\r\n    isHandling: false,\r\n  }\r\n  function handlePause() {\r\n    const { pause } = state\r\n    if (pause) video.current.play();\r\n    else video.current.pause();\r\n    setState(state => ({\r\n      pause: !state.pause,\r\n    }), () => {\r\n      console.log('#', state.pause);\r\n    })\r\n  }\r\n  // 监听播放器进度变化\r\n  function handleTimeUpdate(event){\r\n    // cur 传给子组件使用\r\n    const cur = Math.floor(event.target.currentTime);\r\n    // const { isHandling } = state;\r\n    // if (isHandling) return;\r\n    setState({\r\n      curTime: cur,\r\n    })\r\n    // 如果正在调整播放进度，则不改变进度条的长度\r\n    const width = Math.floor(cur / event.target.duration * 350) || 0;\r\n    // 修改 css 变量 感觉会影响性能\r\n    document.documentElement.style.setProperty('--video-progress-bar-width', width + 'px');\r\n  }\r\n  // 用户改变 audio 播放进度\r\n  function handleProgressChange(newProgress){\r\n    audio.current.currentTime = newProgress;\r\n  }\r\n\r\n  function calcProgress(width){\r\n    const newProgress = Math.floor((width || 0) * ratio);\r\n    handleProgressChange(newProgress);\r\n  }\r\n\r\n  function handleMouseDown(event){\r\n    // \r\n    if (state.isHandling) return;\r\n\r\n    // 是否是点击事件\r\n    let isClick = true;\r\n\r\n    const that = this;\r\n    const { time: totalTime } = props;\r\n    const top = event.target.closest('.Progress-slider-top');\r\n    const bar = event.target.closest('.Progress-slider');\r\n    const barCoord = bar.getBoundingClientRect();\r\n    // 没有点 top，是点击事件\r\n    if (!top) {\r\n      const width = event.clientX - barCoord.left;\r\n      calcProgress(width);\r\n      return;\r\n    }\r\n\r\n    const topCoord = top.getBoundingClientRect();\r\n    setState({\r\n      isHandling: true,\r\n    })\r\n\r\n    // 鼠标指针点击位置与 top 左上角的 offset\r\n    const start = {\r\n      x: event.clientX,\r\n      y: event.clientY\r\n    }\r\n    const offset = {\r\n      x: event.clientX - topCoord.left,\r\n      y: event.clientY - topCoord.top,\r\n    }\r\n\r\n    document.addEventListener('mousemove', handleMouseMove);\r\n    document.addEventListener('mouseup', handleMouseUp);\r\n\r\n    function handleMouseMove(event) {\r\n      if (isClick && Math.floor(Math.abs(event.clientX - start.x) * that.ratio) != 0) isClick = false;\r\n\r\n      // 拖拽时只改变 css 变量的值\r\n      let width = event.clientX - barCoord.left;\r\n      width = width < 350 ? width : 350;\r\n      width = width > 0 ? width : 0;\r\n\r\n      that.setState({\r\n        curTime: Math.floor(width * that.ratio),\r\n      })\r\n      document.documentElement.style.setProperty('--progress-bar-width', width + 'px');\r\n    }\r\n\r\n    function handleMouseUp(event) {\r\n      document.removeEventListener('mousemove', handleMouseMove);\r\n      document.removeEventListener('mouseup', handleMouseUp);\r\n\r\n      that.setState({\r\n        isHandling: false,\r\n      })\r\n      const width = event.clientX - barCoord.left;\r\n\r\n      if (!isClick && !event.target.closest('.Progress-slider')) bar.classList.remove('Progress-slider-hover');\r\n      that.calcProgress(width);\r\n    }\r\n  }\r\n    let url = props.video?.url;\r\n    let totalTime = props?.duration;\r\n    url = url ? url : '';\r\n    totalTime = totalTime ? totalTime/1000 : 0;\r\n    const { curTime, isHandling, pause } = state;\r\n    return (\r\n      <div className='VideoPage'>\r\n        <div className='video-control'>\r\n          <div class=\"video-block\">\r\n            <video\r\n              onTimeUpdate={handleTimeUpdate}\r\n              height='100%'\r\n              ref={video}\r\n              src={url}\r\n              autoPlay\r\n              preload='auto'></video>\r\n          </div>\r\n          <div className='video-control-bar'>\r\n            <div className='video-progress'>\r\n              <div className='video-progress-bar'></div>\r\n              <div className='video-progress-top'></div>\r\n            </div>\r\n            <ul>\r\n              <li className='video-pause' onClick={handlePause}>\r\n                {pause ? <PlayIcon /> : <PauseIcon />}\r\n                <span>{(\"0\" + Math.floor(curTime / 60)).slice(-2)}:\r\n          {(\"0\" + (curTime % 60)).slice(-2)} / {(\"0\" + Math.floor(totalTime / 60)).slice(-2)}:\r\n          {(\"0\" + (totalTime % 60)).slice(-2)}</span>\r\n              </li>\r\n              <li className='video-func'><SoundIcon /><FullScreenIcon /></li>\r\n            </ul>\r\n          </div>\r\n\r\n        </div>\r\n\r\n      </div>\r\n\r\n    )\r\n}\r\n\r\nexport default connect(\r\n  state => ({ \r\n    video: state.video,\r\n    duration:state.duration,  \r\n  }),\r\n  {}\r\n)(VideoPage)"]},"metadata":{},"sourceType":"module"}